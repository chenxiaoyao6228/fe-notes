## 前言

本文梳理矢量(向量)相关的知识点， 方便快速复习

## 坐标系

- 左手/右手法则，坐标系
- 真实案例，旋转

## 4.3 点和矢量

![https://github.com/chenxiaoyao6228/cloudimg/2024/dot-vector.png](https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2024/dot-vector.png)

### **单位矢量的定义**：

- 单位矢量是指其模（长度）为 1 的矢量。单位矢量的计算公式为 \(\hat{v} = \frac{v}{|v|}\)，其中 \(v\) 是非零矢量， \(|v|\) 是 \(v\) 的模。
- 通过示例 \(\left(\frac{3, -4}{\sqrt{3^2 + (-4)^2}}\right) = \left(\frac{3, -4}{5}\right) = (0.6, -0.8)\)，展示了单位矢量的计算过程。

### **零矢量**：

- 零矢量是所有分量值均为 0 的矢量（例如 \(v=(0,0,0)\)），不能归一化，因为模为 0，无法进行除法运算。

**几何意义**：

- 在二维空间中，可以画一个单位圆，从圆心出发到圆边界的矢量即为单位矢量。
- 在三维空间中，单位矢量则是从单位球的球心出发，到达球面的矢量。
- 图 4.21 展示了二维空间中的一些单位矢量，这些矢量都落在单位圆上。

**注意事项**：

- 在后续章节中可能遇到的法线方向（法矢量）或光源方向等，这些矢量不一定是单位矢量。
- 因为计算往往需要单位矢量，使用前应先将这些矢量归一化。

### 点积

![https://github.com/chenxiaoyao6228/cloudimg/2024/dot-product-symbol.png](https://cdn.jsdelivr.net/gh/chenxiaoyao6228/cloudimg@main/2024/dot-product-symbol.png)

这部分内容介绍了矢量点积的定义和应用，特别是矢量投影。

1. **矢量点积的定义和计算**：

   - 点积具有交换律，即 \(a \cdot b = b \cdot a\)。
   - 示例计算：
     - \((1, 2, 3) \cdot (0.5, 4, 2.5) = 0.5 + 8 + 7.5 = 16\)
     - \((-3, 4, 0) \cdot (5, -1, 7) = -15 + 4 + 0 = -19\)

2. **点积的几何意义**：

   - 点积的重要应用之一是**投影**（projection）。
   - 投影定义：假设有一个单位矢量 \(a\) 和另一个长度不限的矢量 \(b\)，希望得到 \(b\) 在方向 \(a\) 上的投影。这个投影可以通过点积 \(a \cdot b\) 来得到 \(b\) 在 \(a\) 方向上的有符号投影。

3. **投影的解释**：

   - 解释方式：可以假设有一个光源，光线垂直于 \(a\) 方向，那么 \(b\) 在 \(a\) 方向上的投影就是 \(b\) 在 \(a\) 方向上的影子。如图 4.22 所示。

4. **注意事项**：
   - 投影值可以是负数，投影结果的正负号与 \(a\) 和 \(b\) 的方向有关：
     - 当它们的方向相反（夹角大于 90°）时，结果小于 0；
     - 当它们的方向互相垂直（夹角为 90°）时，结果等于 0；
     - 当它们的方向相同（夹角小于 90°）时，结果大于 0。
   - 图 4.23 展示了这三种情况的图示。

通过这些内容，我们可以更好地理解矢量点积和投影在几何中的应用。

这部分内容继续介绍矢量点积的性质和应用。

1. **点积的符号与矢量方向的关系**：

   - 点积的符号可以告诉我们两个矢量的方向关系。

2. **非单位矢量的点积**：

   - 如果 \(a\) 不是一个单位矢量，任何两个矢量的点积 \(a \cdot b\) 等同于 \(b\) 在 \(a\) 方向上的投影值，再乘以 \(a\) 的长度。

3. **点积的重要性质**：

   - 在 Shader 计算中，点积的一些重要性质常被用于计算。

4. **点积的结合标量乘法**：

   - 点积的操作数之一可以是另一个运算的结果，即矢量和标量相乘的结果。
   - 公式如下：
     \[
     (ka) \cdot b = a \cdot (kb) = k(a \cdot b)
     \]

5. **点积的结合矢量加法和减法**：

   - 点积可以与矢量加减法结合，性质类似。
   - 公式如下：
     \[
     a \cdot (b + c) = a \cdot b + a \cdot c
     \]
   - 将上面的 \(c\) 换成 \(-c\) 可以得到减法的版本。

6. **矢量与自身点积**：
   - 一个矢量和自身进行点积的结果是该矢量模的平方。
   - 公式验证：
     \[
     v \cdot v = v_x v_x + v_y v_y + v_z v_z = |v|^2
     \]

通过这些性质和公式，可以更好地理解和应用矢量点积的各种特性。

这部分内容介绍了矢量点积与角度之间的关系，并详细解释了相关公式的推导和应用。

1. **点积与角度的关系**：

   - 我们可以直接利用点积来求矢量的模，而不需要使用模的计算公式。
   - 当只想比较两个矢量的长度大小时，可以直接使用点积的结果，这样更简单方便。

2. **点积公式的几何解释**：

   - 给出公式：
     \[
     a \cdot b = |a||b|\cos \theta
     \]
   - 初看之下，这个公式似乎与之前的公式没有关系，但实际上，它们是等价的。

3. **推导过程**：

   - 考虑两个单位矢量 \( \hat{a} \) 和 \( \hat{b} \)，如图 4.24 所示。
   - \( \hat{a} \cdot \hat{b} \) 的结果刚好是 \( \cos \theta \)，这是因为：
     \[
     \hat{a} \cdot \hat{b} = |\hat{a}||\hat{b}|\cos \theta = \cos \theta
     \]
   - 由图 4.24 可以看出：
     \[
     \cos \theta = \frac{|\text{直角边}|}{|\text{斜边}|}
     \]

4. **公式推导**：

   - 通过上述关系可以得出公式：
     \[
     a \cdot b = |a||b|\cos \theta
     \]
   - 这意味着，两个矢量的点积可以表示为两个矢量的模相乘，再乘以它们之间夹角的余弦值。

5. **应用**：

   - 这个公式也解释了为什么计算投影时两个矢量方向不同会得到不同符号的投影值。
   - 当夹角小于 90° 时， \(\cos \theta > 0\)；当夹角等于 90° 时， \(\cos \theta = 0\)；当夹角大于 90° 时， \(\cos \theta < 0\)。

6. **求角度**：
   - 利用这个公式可以求得两个矢量之间的夹角（在 0° 到 180° 之间）：
     \[
     \theta = \arccos \left( \frac{a \cdot b}{|a||b|} \right)
     \]
   - 假设 \(a\) 和 \(b\) 是单位矢量。

通过这些内容，可以更清晰地理解矢量点积的几何意义和应用场景。

### 叉积

这部分内容介绍了矢量的叉积（cross product），也称为外积（outer product）。

1. **叉积定义**：

   - 叉积是另一个重要的矢量运算，结果仍是一个矢量。
   - 叉积的符号是 \( a \times b \)。

2. **叉积公式**：

   - 两个矢量的叉积可以用以下公式计算：
     \[
     a \times b = (a_x, a_y, a_z) \times (b_x, b_y, b_z) = (a_y b_z - a_z b_y, a_z b_x - a_x b_z, a_x b_y - a_y b_x)
     \]
   - 这个公式看起来复杂，但实际上有一定规律。

3. **计算规则**：
   - 图 4.25 展示了三维矢量叉积的计算规律。
   - 不同颜色的线表示了计算结果矢量中对应颜色的分量的计算路径。例如，结果矢量的第一个分量，它是从第一个矢量的 \(y\) 分量出发乘以第二个矢量的 \(z\) 分量，再减去第一个矢量的 \(z\) 分量和第二个矢量的 \(y\) 分量的乘积。

通过这些内容，可以更好地理解和应用矢量叉积的计算方法和几何意义。

### 矢量的叉积

#### 例子

例如，计算以下两个矢量的叉积：

\[ (1, 2, 3) \times (2, -1, 4) \]

计算过程如下：
\[ ((2)(4) - (3)(-1), (3)(2) - (1)(4), (1)(-1) - (2)(2)) = (11, 10, -3) \]

需要注意的是，叉积不满足交换律，即：
\[ a \times b \neq b \times a \]
实际上，叉积满足反交换律，即：
\[ a \times b = -(b \times a) \]

叉积也不满足结合律，即：
\[ (a \times b) \times c \neq a \times (b \times c) \]

#### 几何意义

从几何意义上讲，我们可以更深刻地理解叉积。对于两个矢量进行叉积的结果，得到一个同时垂直于这两个矢量的新矢量。我们已经知道，矢量是由它的模和方向定义的，那么这个新矢量的模和方向是什么呢？

#### 叉积模的计算

我们先来看它的模。 \(a \times b\) 的长度等于 \(a\) 和 \(b\) 的模的乘积再乘以它们之间夹角的正弦值。公式如下：
\[ |a \times b| = |a||b|\sin \theta \]

从公式中可以看出，叉积和点积的计算公式类似，不同的是这里使用的是正弦值。

#### 几何解释

如图 4.26 所示，我们使用 \(a\) 和 \(b\) 构建一个平行四边形。我们知道，平行四边形的面积可以使用 \( |b| |a| \sin \theta \) 来得到，即底乘以高。而叉积可以使用 \(a\) 和夹角 \(\theta\) 来得到：
\[ A = |b| |a| \sin \theta = |a \times b| \]

#### 方向确定

那么，叉积结果矢量的方向呢？这里我们会说：“方向？”不是已经知道了方向吗，就是和两个矢量都垂直就可以了啊”。但是，如果你仔细想一下就会发现，实际上我们有两个方向可以选择。这就是要提到的左手坐标系和右手坐标系。

#### 右手法则

来，举起你的右手！在右手坐标系中，\(a \times b\) 的方向将使用右手法则来判断。我们想象把手心放在 \(a\) 和 \(b\) 的尾部交点处，然后张开你的手掌让手掌方向和 \(a\) 的方向重合，再弯曲你的四指让它们向 \(b\) 的方向靠拢，最后伸出你的大拇指！大拇指指向的方向就是右手坐标系中 \(a \times b\) 的方向。

同理，我们可以使用左手法则来判断左手坐标系中 \(a \times b\) 的方向。

#### 注意事项

虽然看起来左手和右手坐标系的选择会影响叉积的结果，但这仅仅是“看起来”而已。从叉积的数学表达式上可以发现，使用左手坐标系还是右手坐标系不会对计算结果产生任何影响，它影响的只是数字在三维空间中的视觉化表现而已。

### 总结

叉积的最常见应用是计算垂直于一个平面、三角形的矢量。此外，还可以用右手判断一面向的朝向。

通过这些内容，我们可以更好地理解矢量叉积的几何意义和计算方法。

这部分内容继续探讨了叉积的方向确定方法及其应用。

### 叉积方向的确定

1. **左手法则与右手法则**：

   - **右手法则**：将右手的手心放在 \(a\) 和 \(b\) 的尾部交点处，手掌方向与 \(a\) 的方向重合，弯曲四指向 \(b\) 的方向靠拢，伸出大拇指，大拇指指向的方向就是右手坐标系中 \(a \times b\) 的方向。
   - **左手法则**：与右手法则类似，但使用左手。举起左手按右手法则操作，会发现这个姿势比较别扭。

2. **选择坐标系的影响**：
   - 左手坐标系和右手坐标系的选择只会影响结果的方向，而不会影响计算结果的数值。
   - 当从右手坐标系转换为左手坐标系时，所有点和矢量的表达式和计算方式保持不变，只是视觉上会出现反转。
   - 如果需要两个坐标系有同样的视觉效果，可能需要改变一些数学运算，这不在本书的范围内。

### 叉积的应用

1. **计算垂直于平面的矢量**：
   - 叉积的一个常见应用是计算垂直于一个平面或三角形的矢量。
2. **判断三角形的朝向**：
   - 叉积还可以用来判断三角形的朝向。

### 图示

- **图 4.28**：使用右手法则判断右手坐标系中 \(a \times b\) 的方向。图中展示了手掌的弯曲方向和拇指方向与叉积方向的一致性。

通过这些内容，可以更好地理解叉积的方向确定方法及其在几何中的应用。
